<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ridravy</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>

    <style>
        /* =========================================
           ESTILO GERAL DO SITE (AMOLED + VERMELHO)
           ========================================= */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #000000;
            color: #e0e0e0;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        header {
            background-color: #000000;
            width: 100%;
            padding: 30px 0;
            text-align: center;
            border-bottom: 2px solid #ff0000;
            margin-bottom: 20px;
        }

        header h1 {
            margin: 0;
            color: #ff0000;
            letter-spacing: 3px;
            text-transform: uppercase;
            text-shadow: 0 0 10px rgba(255, 0, 0, 0.5);
        }

        /* --- BARRA DE NAVEGAÇÃO --- */
        .tab-container {
            width: 95%;
            max-width: 1200px;
            background-color: #000000;
            border: 1px solid #333;
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 50px;
        }

        .tab-buttons {
            overflow: hidden;
            background-color: #0a0a0a;
            border-bottom: 1px solid #333;
            display: flex; /* Para alinhar melhor */
            flex-wrap: wrap;
        }

        .tab-buttons button {
            background-color: inherit;
            border: none;
            outline: none;
            cursor: pointer;
            padding: 14px 24px;
            transition: 0.3s;
            font-size: 16px;
            color: #888;
            font-weight: bold;
            border-right: 1px solid #222;
        }

        .tab-buttons button:hover {
            background-color: #111;
            color: #ff4d4d;
        }

        .tab-buttons button.active {
            background-color: #000000;
            color: #ff0000;
            border-bottom: 2px solid #ff0000;
        }

        /* CLASSE PARA OCULTAR BOTÕES */
        .hidden-tab-btn {
            display: none;
        }

        /* --- CONTEÚDO DAS ABAS --- */
        .tabcontent {
            display: none;
            padding: 30px;
            border-top: none;
            animation: fadeEffect 0.5s;
        }

        @keyframes fadeEffect {
            from {opacity: 0;}
            to {opacity: 1;}
        }

        /* --- HOME & CLIENTE --- */
        .intro-box, .login-box {
            text-align: center;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.6;
            padding: 40px 20px;
        }

        .contact-email {
            color: #ff0000;
            font-weight: bold;
            text-decoration: none;
            border: 1px solid #ff0000;
            padding: 10px 20px;
            border-radius: 5px;
            display: inline-block;
            margin-top: 10px;
            transition: 0.3s;
        }
        .contact-email:hover {
            background-color: #ff0000;
            color: #000000;
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.6);
        }

        /* Estilo do Login */
        .login-input {
            padding: 12px;
            font-size: 16px;
            background: #222;
            border: 1px solid #444;
            color: white;
            border-radius: 4px;
            width: 250px;
            text-align: center;
            margin-right: 10px;
        }
        .login-input:focus {
            outline: none;
            border-color: #ff0000;
        }

        .login-btn {
            padding: 12px 25px;
            background: #ff0000;
            color: white;
            border: none;
            border-radius: 4px;
            font-weight: bold;
            cursor: pointer;
            text-transform: uppercase;
        }
        .login-btn:hover {
            background: #c92a2a;
        }

        /* =========================================
           ESTILO: CHAMADO PADRÃO
           ========================================= */
        .glpi-wrapper { --bg-panel: #1c1c1c; --accent-red: #ff3b3b; }
        .glpi-container {
            background: var(--bg-panel); width: 100%; padding: 30px; border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5), 0 0 20px rgba(255, 59, 59, 0.1);
            display: flex; gap: 25px; border: 1px solid #333; box-sizing: border-box;
        }
        @media (max-width: 768px) { .glpi-container { flex-direction: column; } }
        .glpi-column { flex: 1; display: flex; flex-direction: column; }
        .glpi-title { margin-top: 0; color: #ff3b3b; font-size: 20px; margin-bottom: 15px; text-transform: uppercase; letter-spacing: 1px; }
        .instruction { font-size: 13px; color: #a0a0a0; margin-bottom: 10px; }
        .glpi-input-field {
            flex: 1; padding: 15px; border: 1px solid #444; border-radius: 6px; font-family: 'Consolas', monospace; font-size: 14px; resize: vertical;
            background-color: #2a2a2a; color: #e0e0e0; width: 100%; box-sizing: border-box;
        }
        .glpi-input-field:focus { outline: none; border-color: #ff3b3b; box-shadow: 0 0 10px rgba(255, 59, 59, 0.3); }
        #glpi_input { min-height: 450px; }
        #glpi_output { min-height: 300px; }
        .output-area { background-color: #1a0d0d; border-color: #5c1e1e; color: #ffcece; font-weight: bold; }
        .glpi-controls { background: #252525; padding: 20px; border-radius: 8px; border: 1px solid #444; margin-bottom: 20px; }
        .glpi-label { font-weight: bold; font-size: 14px; color: #ff3b3b; display: block; margin-bottom: 8px; }
        .glpi-select { width: 100%; margin-bottom: 20px; cursor: pointer; padding: 10px; background-color: #2a2a2a; color: #fff; border: 1px solid #444; border-radius: 4px; }
        .checkbox-container { display: flex; align-items: center; cursor: pointer; user-select: none; }
        .checkbox-container input { width: 20px; height: 20px; margin-right: 12px; cursor: pointer; accent-color: #ff3b3b; }
        .glpi-btn {
            margin-top: 15px; padding: 15px; background-color: #ff3b3b; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 16px; font-weight: bold; text-transform: uppercase; transition: all 0.2s; box-shadow: 0 4px 15px rgba(255, 59, 59, 0.3); width: 100%;
        }
        .glpi-btn:hover { background-color: #c92a2a; transform: translateY(-2px); }

        /* =========================================
           ESTILO: VALE CARGA SAMU
           ========================================= */
        .vale-carga-app {
            --cor-fundo-vc: #1e1e1e; --cor-superficie-vc: #1c1c1c; --cor-borda-vc: #444;
            --cor-texto-principal-vc: #e0e0e0; --cor-texto-secundario-vc: #a0a0a0;
            --cor-primaria-vc: #ff3b3b; --cor-primaria-hover-vc: #c92a2a;
            --cor-destrutiva-vc: #b91c1c; --cor-neutra-vc: #333; --raio-borda-vc: 6px;
        }
        .vale-carga-container {
            width: 100%; background: var(--cor-superficie-vc); border-radius: 8px;
            border: 1px solid #333; box-shadow: 0 10px 30px rgba(0,0,0,0.5), 0 0 20px rgba(255, 59, 59, 0.1);
        }
        .vale-carga-app * { box-sizing: border-box; }
        .vale-carga-app .app-header, .vale-carga-app .app-body, .vale-carga-app .app-footer { padding: 1.5rem; }
        .vale-carga-app .app-header-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 1rem; }
        .vale-carga-app .form-group { display: flex; flex-direction: column; }
        .vale-carga-app .form-group label { font-size: 0.8rem; margin-bottom: 0.3rem; color: var(--cor-texto-secundario-vc); font-weight: 500; }
        .vale-carga-app input[type="text"] {
            background-color: #2a2a2a; border: 1px solid var(--cor-borda-vc); color: var(--cor-texto-principal-vc);
            border-radius: var(--raio-borda-vc); padding: 0.6rem; font-size: 0.9rem; outline: none; text-align: center;
        }
        .vale-carga-app input[type="text"]:focus { border-color: #ff3b3b; }
        .vale-carga-app .table-container { max-height: 400px; overflow-y: auto; border: 1px solid var(--cor-borda-vc); border-radius: var(--raio-borda-vc); }
        .vale-carga-app table { width: 100%; border-collapse: collapse; }
        .vale-carga-app th, .vale-carga-app td { padding: 0.75rem; text-align: center; border-bottom: 1px solid #333; }
        .vale-carga-app thead { position: sticky; top: 0; background-color: #3a3a3a; text-transform: uppercase; color: white; }
        .vale-carga-app td input[type="text"] { width: 100%; margin: 0 auto; background: transparent; border: none; }
        .vale-carga-app td input[type="text"]:focus { background: #2d2d2d; }
        .vale-carga-app .item-tombo { max-width: 150px; }
        .vale-carga-app .item-qtd { max-width: 70px; }
        .vale-carga-app .app-footer { border-top: 1px solid var(--cor-borda-vc); display: grid; grid-template-columns: 1fr 1fr 2fr; gap: 1rem; }
        .vale-carga-app .btn {
            padding: 0.8rem 1rem; border: none; border-radius: var(--raio-borda-vc); font-weight: 600; font-size: 0.9rem; cursor: pointer; color: white; display: flex; justify-content: center; align-items: center; gap: 0.5rem; text-transform: uppercase; transition: 0.3s;
        }
        .vale-carga-app .btn-primary { background-color: var(--cor-primaria-vc); }
        .vale-carga-app .btn-primary:hover { background-color: var(--cor-primaria-hover-vc); }
        .vale-carga-app .btn-danger { background-color: var(--cor-destrutiva-vc); }
        .vale-carga-app .btn-secondary { background-color: var(--cor-neutra-vc); }

    </style>
</head>
<body>

    <header>
        <h1>Ridravy</h1>
    </header>

    <div class="tab-container">
        <div class="tab-buttons">
            <button class="tablinks" onclick="openTab(event, 'Home')" id="defaultOpen">Home</button>
            
            <button class="tablinks" onclick="openTab(event, 'AreaCliente')">Área do Cliente</button>

            <button class="tablinks hidden-tab-btn" id="btnChamado" onclick="openTab(event, 'ChamadoPadrao')">Chamado Padrão</button>
            <button class="tablinks hidden-tab-btn" id="btnVale" onclick="openTab(event, 'ValeCargaSamu')">Vale Carga SAMU</button>
        </div>

        <div id="Home" class="tabcontent">
            <div class="intro-box">
                <h2 style="color: #ff0000;">Bem-vindo</h2>
                <p>Esse site mantém alguns softwares frees criados por <strong>Ridravy</strong>.</p>
                <p>Caso queira comprar um editado ou um exclusivo seu ou da sua empresa, entre em contato:</p>
                <br>
                <a href="mailto:contatoafr@gmail.com" class="contact-email">contatoafr@gmail.com</a>
            </div>
        </div>

        <div id="AreaCliente" class="tabcontent">
            <div class="login-box">
                <h2 style="color: #ff0000;">Área do Cliente</h2>
                <p>Digite sua chave de acesso para liberar as ferramentas exclusivas.</p>
                <br>
                <input type="password" id="senhaInput" class="login-input" placeholder="Digite a senha..." onkeydown="if(event.key === 'Enter') verificarSenha()">
                <button class="login-btn" onclick="verificarSenha()">Entrar</button>
                <br><br>
                <p id="msgLogin" style="color: #ff3b3b; font-weight: bold; display: none;"></p>
            </div>
        </div>

        <div id="ChamadoPadrao" class="tabcontent glpi-wrapper">
            <div class="glpi-container">
                <div class="glpi-column">
                    <h2 class="glpi-title">Entrada de Dados</h2>
                    <p class="instruction">Use Ctrl+A e Ctrl+C no chamado, depois Ctrl+V aqui:</p>
                    <textarea id="glpi_input" class="glpi-input-field" placeholder="// Cole o texto bruto do sistema aqui..."></textarea>
                </div>
                <div class="glpi-column">
                    <h2 class="glpi-title">Resultado Formatado</h2>
                    <div class="glpi-controls">
                        <label class="glpi-label" for="glpi_statusSelect">Definir Status Final:</label>
                        <select id="glpi_statusSelect" class="glpi-select">
                            <option value="[ENCERRADO]  ✅" selected>Encerrado ✅</option>
                            <option value="[SUSPENSO] ⚠️">Suspenso ⚠️</option>
                            <option value="[ENCAMINHADO] ⤵️">Encaminhado ⤵️</option>
                        </select>
                        <label class="checkbox-container">
                            <input type="checkbox" id="glpi_checkComentarios" checked>
                            <span>Incluir histórico de comentários?</span>
                        </label>
                    </div>
                    <textarea id="glpi_output" class="glpi-input-field output-area" readonly placeholder="// O texto pronto aparecerá aqui."></textarea>
                    <button class="glpi-btn" onclick="copyToClipboard()">Copiar Resultado</button>
                </div>
            </div>
        </div>

        <div id="ValeCargaSamu" class="tabcontent vale-carga-app">
            <div class="vale-carga-container">
                <header class="app-header">
                    <div class="app-header-grid">
                        <div class="form-group"><label for="vc_origem">Origem</label><input type="text" id="vc_origem" value="NTI SAMU"></div>
                        <div class="form-group"><label for="vc_destino">Destino</label><input type="text" id="vc_destino" placeholder="Para onde vai o material"></div>
                        <div class="form-group"><label for="vc_data">Data</label><input type="text" id="vc_data"></div>
                        <div class="form-group"><label for="vc_ticket">Ticket (Opcional)</label><input type="text" id="vc_ticket" placeholder="Nº do chamado"></div>
                    </div>
                </header>
                <section class="app-body">
                    <div class="table-container">
                        <table>
                            <thead><tr><th>Item</th><th>Descrição</th><th>Tombo / IBT</th><th>Qtd</th></tr></thead>
                            <tbody id="vc_items-tbody"></tbody>
                        </table>
                    </div>
                </section>
                <footer class="app-footer">
                    <button id="vc_btn-blank" class="btn btn-secondary">PDF em Branco</button>
                    <button id="vc_btn-clear" class="btn btn-danger">Limpar Tudo</button>
                    <button id="vc_btn-generate" class="btn btn-primary">Gerar e Salvar PDF</button>
                </footer>
            </div>
        </div>

    </div>

    <script>
        // --- LÓGICA DE SENHA E NAVEGAÇÃO ---
        
        // 1. Controle das Abas
        function openTab(evt, tabName) {
            var i, tabcontent, tablinks;
            
            // Esconde todo conteúdo
            tabcontent = document.getElementsByClassName("tabcontent");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }
            
            // Tira classe 'active' de todos os botões
            tablinks = document.getElementsByClassName("tablinks");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }
            
            // Mostra a aba desejada e ativa o botão
            document.getElementById(tabName).style.display = "block";
            if(evt) {
                evt.currentTarget.className += " active";
            } else {
                // Caso seja chamada via código (sem clique), tenta achar o botão pelo texto ou ID para ativar visualmente
                // (Opcional para simplificar)
            }
        }

        // Abre a Home por padrão ao carregar
        document.getElementById("defaultOpen").click();

        // 2. Lógica de Login
        function verificarSenha() {
            var senhaDigitada = document.getElementById("senhaInput").value;
            var msg = document.getElementById("msgLogin");

            if (senhaDigitada === "samu192@") {
                // Senha CORRETA
                msg.style.display = "block";
                msg.style.color = "#28a745"; // Verde
                msg.innerHTML = "Acesso Autorizado! Carregando ferramentas...";

                // Mostra os botões ocultos removendo o display:none do CSS inline ou da classe
                document.getElementById("btnChamado").style.display = "block";
                document.getElementById("btnVale").style.display = "block";

                // Limpa o campo
                document.getElementById("senhaInput").value = "";

                // (Opcional) Já abre a primeira ferramenta automaticamente após 1 segundo
                setTimeout(function(){
                    // Simula um clique no botão do chamado padrão para abrir a aba
                    document.getElementById("btnChamado").click();
                    msg.style.display = "none";
                }, 800);

            } else {
                // Senha INCORRETA
                msg.style.display = "block";
                msg.style.color = "#ff3b3b"; // Vermelho
                msg.innerHTML = "Senha Incorreta. Tente novamente.";
                
                // Treme a caixa de input (efeito visual simples)
                var input = document.getElementById("senhaInput");
                input.style.borderColor = "red";
                setTimeout(() => { input.style.borderColor = "#444"; }, 500);
            }
        }


        // --- LÓGICA DO CHAMADO PADRÃO (GLPI) ---
        const glpiInput = document.getElementById('glpi_input');
        const glpiOutput = document.getElementById('glpi_output');
        const glpiStatusSelect = document.getElementById('glpi_statusSelect');
        const glpiCheckComentarios = document.getElementById('glpi_checkComentarios');

        if(glpiInput) {
            glpiInput.addEventListener('input', processarTextoGLPI);
            glpiStatusSelect.addEventListener('change', processarTextoGLPI);
            glpiCheckComentarios.addEventListener('change', processarTextoGLPI);
        }

        function processarTextoGLPI() {
            const text = glpiInput.value;
            if (!text.trim()) { glpiOutput.value = ""; return; }
            let ticket = "???";
            const ticketMatch = text.match(/Ticket\s*[\r\n]+\s*(\d{5,8})/i);
            if (ticketMatch) ticket = ticketMatch[1];
            let descricao = "Não identificada";
            const descMatch = text.match(/Descrição\*([\s\S]*?)(?:Setor:|Enviar e-mail)/i);
            if (descMatch) descricao = descMatch[1].trim();
            let resolucao = "-";
            const solucaoMatch = text.match(/Solução Resposta\*([\s\S]*?)(?:Negrito|Solução temporária|Sim|Não)/i);
            if (solucaoMatch) resolucao = solucaoMatch[1].trim();
            else if (text.includes("Solução Resposta*")) {
                let parts = text.split("Solução Resposta*");
                if (parts[1]) resolucao = parts[1].split(/\n/)[0];
            }
            let blocoComentarios = "";
            if (glpiCheckComentarios.checked) {
                let comentariosFormatados = "";
                const commentRegex = /(.+?)\s+em\s+\d{1,2}\s+de\s+[a-zç]+\s+de\s+\d{4}.*?[\r\n]+([\s\S]*?)(?:Responder|Comentar|$)/i;
                const historicoStart = text.indexOf("Histórico");
                if (historicoStart > -1) {
                    const areaComentario = text.substring(historicoStart);
                    const comMatch = areaComentario.match(commentRegex);
                    if (comMatch) {
                        let autorData = comMatch[1].trim();
                        let textoComentario = comMatch[2].split("Responder")[0].trim();
                        comentariosFormatados = `- ${autorData}\n  "${textoComentario}"`;
                    } else {
                        let linhas = areaComentario.split('\n').map(l => l.trim()).filter(l => l.length > 2);
                        let preview = linhas.slice(1, 4).join("\n- "); 
                        if (preview) comentariosFormatados = "- " + preview;
                    }
                }
                if (comentariosFormatados) blocoComentarios = `\nComentários:\n${comentariosFormatados}\n`;
            }
            const statusFinal = glpiStatusSelect.value;
            glpiOutput.value = `Ticket nº: ${ticket}\n\nDescrição:\n- ${descricao}\n${blocoComentarios}Resolução:\n- ${resolucao}\n\n${statusFinal}`;
        }

        function copyToClipboard() {
            if(!glpiOutput) return;
            glpiOutput.select();
            document.execCommand('copy');
            const btn = document.querySelector('.glpi-btn');
            const originalText = btn.innerText;
            btn.innerText = "COPIADO! ✅";
            btn.style.backgroundColor = "#28a745"; 
            setTimeout(() => { btn.innerText = originalText; btn.style.backgroundColor = "#ff3b3b"; }, 1500);
        }

        // --- LÓGICA DO VALE CARGA SAMU ---
        (function initValeCarga() {
            const tbody = document.getElementById('vc_items-tbody');
            if (!tbody) return;
            const NUMERO_DE_ITENS = 16;
            const dataInput = document.getElementById('vc_data');
            
            if (tbody.rows.length === 0) {
                for (let i = 1; i <= NUMERO_DE_ITENS; i++) {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `<td>${i.toString().padStart(2, '0')}</td><td><input type="text" class="item-descricao" placeholder="Ex: Monitor, Teclado"></td><td><input type="text" class="item-tombo" placeholder="Ex: 123456"></td><td><input type="text" class="item-qtd" placeholder="Ex: 00"></td>`;
                    tbody.appendChild(tr);
                }
                dataInput.value = new Date().toLocaleDateString('pt-BR');
                document.getElementById('vc_btn-generate').addEventListener('click', () => gerarPDF(coletarDados(), `VALECARGA_PREENCHIDO.pdf`));
                document.getElementById('vc_btn-blank').addEventListener('click', () => gerarPDF(dadosEmBranco(), 'VALECARGA_PARA_PREENCHIMENTO.pdf'));
                document.getElementById('vc_btn-clear').addEventListener('click', handleClearForm);
            }

            function coletarDados() {
                const dados = {
                    cabecalho: {
                        origem: document.getElementById('vc_origem').value.trim(),
                        destino: document.getElementById('vc_destino').value.trim(),
                        data: document.getElementById('vc_data').value.trim(),
                        ticket: document.getElementById('vc_ticket').value.trim() || '-----'
                    },
                    itens: []
                };
                tbody.querySelectorAll('tr').forEach((linha, index) => {
                    const desc = linha.querySelector('.item-descricao').value.trim();
                    let tombo = linha.querySelector('.item-tombo').value.trim();
                    let qtd = linha.querySelector('.item-qtd').value.trim();
                    if(desc){
                        if(!tombo) tombo = "-----";
                        if(!qtd) qtd = "1";
                    }
                    dados.itens.push([`${(index + 1).toString().padStart(2, '0')}`, desc, tombo, qtd]);
                });
                return dados;
            }

            function dadosEmBranco() {
                return {
                    cabecalho: { origem: '', destino: '', data: '', ticket: '' },
                    itens: Array.from({ length: NUMERO_DE_ITENS }, (_, i) => [`${(i + 1).toString().padStart(2, '0')}`, '', '', ''])
                };
            }

            function handleClearForm() {
                if (confirm("Limpar todos os campos?")) {
                    document.getElementById('vc_destino').value = '';
                    document.getElementById('vc_ticket').value = '';
                    tbody.querySelectorAll('input').forEach(input => input.value = '');
                }
            }

            function gerarPDF(dados, nomeDoArquivo) {
                if (!dados.cabecalho.destino && nomeDoArquivo.includes('PREENCHIDO')) {
                    alert("Preencha o campo 'Destino'.");
                    return;
                }
                const { jsPDF } = window.jspdf; 
                const pdf = new jsPDF({ orientation: 'landscape', unit: 'pt', format: 'a4' }); 
                const larguraPagina = pdf.internal.pageSize.getWidth();
                const alturaPagina = pdf.internal.pageSize.getHeight();
                const minhaImagemDeFundo = "AQUI-VAI-UMA-IMAGEM";
                try {
                    if(minhaImagemDeFundo !== "AQUI-VAI-UMA-IMAGEM") pdf.addImage(minhaImagemDeFundo, 'PNG', 0, 0, larguraPagina, alturaPagina);
                } catch (e) { console.error("Erro imagem:", e); }

                const desenharVia = (offsetX) => {
                    pdf.setTextColor(0, 0, 0); 
                    const headerBody = [
                        [{ content: 'ORIGEM', styles: { fontStyle: 'bold' } }, { content: dados.cabecalho.origem }],
                        [{ content: 'DESTINO', styles: { fontStyle: 'bold' } }, { content: dados.cabecalho.destino }],
                        [{ content: 'DATA', styles: { fontStyle: 'bold' } }, { content: dados.cabecalho.data }],
                        [{ content: 'TICKET', styles: { fontStyle: 'bold' } }, { content: dados.cabecalho.ticket }]
                    ];
                    pdf.autoTable({
                        startY: 60, margin: { left: offsetX + 40 }, body: headerBody, theme: 'grid',
                        styles: { font: 'helvetica', fontSize: 9, cellPadding: 4, halign: 'center', fillColor: false, textColor: [0,0,0], lineWidth: 1, lineColor: [0, 0, 0] },
                        columnStyles: { 0: { cellWidth: 80 }, 1: { cellWidth: 100 } },
                    });
                    pdf.autoTable({
                        startY: pdf.lastAutoTable.finalY + 35, margin: { left: offsetX + 40 }, head: [["Item", "Descrição", "Tombo/IBT", "Qtd"]],
                        body: dados.itens, theme: 'grid',
                        styles: { font: 'helvetica', fontSize: 9, cellPadding: 4, halign: 'center', fillColor: false, textColor: [0,0,0], lineWidth: 1, lineColor: [0, 0, 0] },
                        headStyles: { fontStyle: 'bold', fillColor: [220, 220, 220], textColor: [0, 0, 0] },
                        columnStyles: { 0: { cellWidth: 30 }, 1: { cellWidth: 180 }, 2: { cellWidth: 70 }, 3: { cellWidth: 30 } },
                    });
                };
                desenharVia(0);
                desenharVia(larguraPagina / 2);
                pdf.save(nomeDoArquivo);
            }
        })();
    </script>

</body>
</html>
